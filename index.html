<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>时光屋</title>
  <meta name="author" content="Villa Dora">
  
  
  <meta name="viewport" content="width=device-width; initial-scale=1; maximum-scale=1">

  <meta property="og:site_name" content="时光屋"/>

  <link rel="alternate" href="atom.xml" title="时光屋" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-7622998-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

</head>

<body>
  <header id="header" class="inner"><div class="alignleft">
  <!--<h1><a href="/">时光屋</a></h1>-->

  <div id="contenedor">
  <ul class="cube">
    <li class="cara">
        时光屋
    </li>
    <li class="cara"></li>
    <li class="cara"></li>
    <li class="cara"></li>
    <li class="cara"></li>
    <li class="cara">
    Villadora
    </li>
  </ul>
</div>

<script type="text/javascript">
	$(function(){

		var cube = $('.cube'),
				offset = $('#contenedor').offset(),
				offsetleft = (offset.left + 100),
				offsettop = (offset.top + 100);

		cube.on({
			mousemove: function(e) {
				$(this).css('transform','rotateX(' + (e.pageY - offsettop) + 'deg) rotateY(' + (e.pageX - offsetleft) + 'deg)');
				$(this).addClass('noanimar').removeClass('animar');
			},
			mouseout: function() {
				$(this).css('transform','rotateX(0deg) rotateY(0deg)');
				$(this).addClass('animar').removeClass('noanimar');
			}
		});

		//console.log('x=' + offsetleft + ', y=' + offsettop);
});
</script>
<script src="/js/prefixfree.min.js"></script>

</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>


<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-23T09:06:59.000Z">5月 23 2014</time>
      
      
  
    <h1 class="title"><a href="/2014/05/23/amd-define-and-how-to-translate-amd-to-commonjs/">AMD Define and how to translate AMD to CommonJS</a></h1>
  

    </header>
    <div class="entry">
      
        <p>CommonJS和AMD的争论已经有很多，而两者也在项目进化和融合。个人看来CommonJS更面向于开发者，对于开发者来说，需要的是清晰的版本和管理，更少的代码和干扰，更少的配置。而AMD在代码中允许匿名模块，模块名称和变量之间关系的不清晰，非就近依赖，冗余依赖定义都不是开发者友好。</p>
<p><a href="http://www.npmjs.com/require2commonjs" target="_blank">require2commonjs</a> 提供了命令行和node模块来将在requirejs中使用的AMD转化为CommonJS格式，方便其他使用CMD或者 <a href="http://nodejs.org" target="_blank">node</a> <a href="http://github.com/cortexjs/cortex" target="_blank">cortex</a> 等外部系统来使用。</p>
<p>目前的官方AMD提供一下几种方式去定义一个模块：</p>
<p>1) Dependency-free module, simple object</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>define({
    add: <span class="function"><span class="keyword">function</span><span class="params">(a, b)</span> {</span> <span class="keyword">return</span> a + b; }
});
</pre></td></tr></table></figure>

<p>没有任何依赖，直接定义模块的exports。这种情况下要将AMD转话为CommonJS模块，只需要变为</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>module.exports = {
    add: <span class="function"><span class="keyword">function</span><span class="params">(a, b)</span> {</span> <span class="keyword">return</span> a + b; }
};
</pre></td></tr></table></figure>

<p>语法树转换非常简单。</p>
<p>2) Simplified CommonJS wrapping</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre> define(<span class="function"><span class="keyword">function</span> <span class="params">(require, exports, module)</span> {</span>
     <span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'a'</span>),
         b = <span class="built_in">require</span>(<span class="string">'b'</span>);
     exports.action = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>};
 });
</pre></td></tr></table></figure>

<p>现在AMD提供CommonJS wrapping这种格式，更为简单。 只需要将factory函数中的函数体提取出来就可以了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'a'</span>),
    b = <span class="built_in">require</span>(<span class="string">'b'</span>);
    
exports.action = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>};
</pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-21T03:17:55.000Z">5月 21 2014</time>
      
      
  
    <h1 class="title"><a href="/2014/05/21/regexptostring()/">regexp.toString()</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Regexp.toString在不同浏览器下修辞符顺序不一致。</p>
<p>Chrome, firefox</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>var re = <span class="regexp">/abc/gim</span>;
re.toString(); <span class="regexp">//</span> <span class="keyword">return</span> <span class="string">'/abc/gim'</span>
</pre></td></tr></table></figure>

<p>IE 9.0</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>var re = <span class="regexp">/abc/gim</span>;
re.toString(); <span class="regexp">//</span> <span class="keyword">return</span> <span class="string">'/abc/igm'</span>
</pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-06T05:34:00.000Z">5月 6 2014</time>
      
      
  
    <h1 class="title"><a href="/2014/05/06/cookie-version/">Cookie Version in J2EE</a></h1>
  

    </header>
    <div class="entry">
      
        <p>在处理Cookie的时候发现不能处理servlet request中不能获取cookie中的带”:”字符的值.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre>Cookie[] cookies = request.getCookies();
<span class="keyword">if</span> (cookies != <span class="keyword">null</span>) {
    <span class="keyword">for</span> (Cookie cookie : cookies) {
        <span class="keyword">if</span> (StringUtils.equalsIgnoreCase(cookie.getName(), name)) {
            value = cookie.getValue(); <span class="comment">// if the value in cookie is 'http://example.com' then here it will get 'http'</span>
            <span class="keyword">break</span>;
        }
    }
}
</pre></td></tr></table></figure>

<p>这是因为目前Cookie有两个标准，一个是Version 0 (<a href="http://curl.haxx.se/rfc/cookie_spec.html" target="_blank">Netscape spec</a>)</p>
<p>而J2EE的实现描述 Cookie#setValue 中</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>With Version <span class="number">0</span> cookies, values should <span class="keyword">not</span> <span class="keyword">contain</span> white <span class="constant">space</span>, brackets, parentheses, <span class="keyword">equals</span> signs, commas, double quotes, slashes, question marks, <span class="keyword">at</span> signs, colons, <span class="keyword">and</span> semicolons. Empty values may <span class="keyword">not</span> behave <span class="keyword">the</span> same way <span class="function_start"><span class="keyword">on</span></span> all browsers.
`
</pre></td></tr></table></figure>

<p>也就是说Version 0 是不能包含空格，括弧，等号，逗号， 双引号等字符的。 </p>
<p>而Version 1 (<a href="http://www.ietf.org/rfc/rfc2109.txt" target="_blank">RFC 2109 spec</a>) 是可以的。</p>
<p>但是javax.servlet.http.Cookie的实现时默认是使用 Version 0</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="keyword">By</span> <span class="keyword">default</span>, cookies are created according <span class="keyword">to</span> the Netscape cookie specification. The version can be changed <span class="keyword">with</span> the
setVersion <span class="function"><span class="keyword">method</span>.</span>
</pre></td></tr></table></figure>

<p>而看起来container默认的选择也是使用了Version 0而没有去改变version。所以当Cookie值中带有’:’时，就无法读到colon后的内容。</p>
<p>如果没有办法改container并且只能使用默认的request的话，暂时的解决方案是在写cookie的时候URLEncode, 然后在服务器端读的时候做URLDecode。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-04-08T02:18:00.000Z">4月 8 2014</time>
      
      
  
    <h1 class="title"><a href="/2014/04/08/isroll-event-preventDefault/">Iscroll5的几个bug</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Iscroll是在移动端开发不可缺少的组件，至少在实现原生的overflow:scroll之前。其中碰到有两个问题。</p>
<ol>
<li>Function.prototype.bind iscroll5在indicator中使用了bind, 但是这个bind在2.x的android浏览器上和webview中都没法使用，导致脚本出错。</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="keyword">this</span>.fadeTimeout = setTimeout((function (<span class="keyword">val</span>) {
    <span class="keyword">this</span>.wrapperStyle.opacity = <span class="keyword">val</span>;
    <span class="keyword">this</span>.visible = +<span class="keyword">val</span>;
}).bind(<span class="keyword">this</span>, <span class="keyword">val</span>), delay);
</pre></td></tr></table></figure>

<p>去掉bind, 改成closure解决问题</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="keyword">var</span> selft = this;
<span class="keyword">self</span>.fadetimeout = setTimeout(<span class="function"><span class="keyword">function</span> <span class="params">(val)</span> {</span>
    <span class="keyword">self</span>.wrapperStyle.opacity = val;
    <span class="keyword">self</span>.visible = +val;
}, delay);
</pre></td></tr></table></figure>

<p>这个修正已经有人发了 pullrequest 只不过暂时还没有merge到master分支中。</p>
<ol>
<li>click事件多次触发。在有些浏览器上会发现使用了iscroll的元素click事件会导致多次触发, 这是因为iscroll为了模拟滑动事件，屏蔽了scroll元素上的click事件，而自己通过touchend来决定是否触发模拟的click事件。但是在移动上的有些浏览器上e.preventDefault并不能阻止事件，因为click事件的cancelable为false。 这个时候只能检测e.cancelable属性，然后决定是否要产生模拟事件。</li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-03-06T07:18:00.000Z">3月 6 2014</time>
      
      
  
    <h1 class="title"><a href="/2014/03/06/passport-openid-nodejs/">在cluster中使用passport openID</a></h1>
  

    </header>
    <div class="entry">
      
        <h1 id="Passport_openid_in_cluster">Passport openid in cluster</h1>
<p>使用nodejs的cluster可以让我们更好的利用cpu资源, 但是同时也会带来一些问题.</p>
<h2 id="session">session</h2>
<p>这个大家都应该知道如果使用in memory session, 那么不同的cluster之间就不能共享session也会导致login失败, 解决办法很简单,使用redis或者mongo这种持久层来保存cookie, 或者可以使用sticky-session之类来固定cluster (但是stikcy-session这个模块是基于ip，在proxy背后会失去作用，没有找到源码，不推荐).</p>
<h2 id="open_id_association">open id association</h2>
<p>association是用来在replyParty和openID provider之间建立一个共享的secret, 这样在接下来的访问中就可以通过association来判断对方是不是伪造的。<br>但是再使用了cluster之后,http请求被分发给了不同的process, 前面拿到的association在另一个process里面正常的模式下是拿不到的，这个时候请求会被当作一个没有授权的请求,从而要求用户重新登录。解决办法是在passport的strategy中设置saveAssociation和loadAssociation将openIdAssocation存到redis或者mongodb中。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="code"><pre>    <span class="keyword">var</span> passport = <span class="built_in">require</span>(<span class="string">'passport'</span>);
    <span class="keyword">var</span> strategy = <span class="keyword">new</span> GoogleStrategy({
        returnURL: callbackURL,
        realm: realm,
        stateless: <span class="literal">true</span>
    };
    
    <span class="comment">// ...</span>

    strategy.saveAssociation(<span class="function"><span class="keyword">function</span><span class="params">(handle, provider, algorithm, secret, expiresIn, done)</span> {</span>
        <span class="keyword">var</span> assoc = {
            handle: handle,
            provider: provider,
            algorithm: algorithm,
            secret: secret,
            expiresIn: expiresIn
        };
        
        <span class="comment">// save to redis/mongodb</span>
        save(<span class="function"><span class="keyword">function</span><span class="params">(err)</span> {</span>
            done(err);
        });
    });

    strategy.loadAssociation(<span class="function"><span class="keyword">function</span><span class="params">(handle, done)</span> {</span>
        <span class="comment">// load from redis/mongodb</span>
        load(handle, <span class="function"><span class="keyword">function</span><span class="params">(err, assoc)</span> {</span>
            <span class="keyword">if</span>(err) <span class="keyword">return</span> done(err);
            done(err, assoc.provider, assoc.algorithm, assoc.secret);
        });
    });
    
    passport.use(strategy);
</pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-08-08T08:00:19.000Z">8月 8 2013</time>
      
      
  
    <h1 class="title"><a href="/2013/08/08/arguments-exceed-javascript/">javascript arguments长度限制</a></h1>
  

    </header>
    <div class="entry">
      
        <p>先看下这一段代码片段(in chrome):</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="keyword">var</span> a = [];
a[<span class="number">2</span>&lt;&lt;<span class="number">16</span>] = <span class="number">1</span>;
fucntion b() {}
b.apply([], a);
</pre></td></tr></table></figure>

<p>这段代码最终回导致RangeError: Maximum call stack size exceed. 实际上并不是因为调用栈满了，而只是数组长度太长了.<br>为什么会这样呢？ 不是在<code>a[2&lt;&lt;16] = 1</code>的时候还好好的吗？<br>大家都知道javascript的数组并不是真的数组，而只是一个特殊的以数组作为key的table而已，这点和lua是一样的。所以当我们在执行<code>a[2&lt;&lt;16] = 1</code>的时候，其实这生成的只不过是一个只有一个键值<em>2&lt;&lt;16</em>的表，空间只有1，这是没有任何问题的。</p>
<p>但当我们把一个数组作为arguments传递给一个函数时，情况就变了；同样，大家都知道arguments不是真的数组，它没有Array.push/pop等方法。但是我们可以把一个数组作为参数传递给apply方法，作为argumetns去调用一个函数。<br>实际的情况是，在这个时候你的数组虽然是一个table，但是在这个时候只能一个个的传递到栈上，没错,因为arguments是分配在Stack上的，而Array是分配在Heap上的。从某种意义上来数arguments才是真正的数组: 线性空间排序, 顺序访问。而Array更像上是Hash Table。接下来发生什么？javascript vm尝试去读取arguments中的参数，一个一个的把它放到调用栈上，传递给之后调用的函数,于是<code>for(var i = 0; i &lt; (2&lt;&lt;16); ++)...</code>，调用栈都被使用慢了！本来只占据Heap中一个位置，现在占据了整个栈的空间。而调用栈空间满了之后，会发生什么错误？就是我们开头看到的<em>RangeError: Maximum call stack size exceed.</em>， 而实际上叫做<em>Function arguments exceed the maximun limit.</em>更好些.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-08-06T05:51:11.000Z">8月 6 2013</time>
      
      
  
    <h1 class="title"><a href="/2013/08/06/interupt-when-hexo-generating/">interupt when hexo generating</a></h1>
  

    </header>
    <div class="entry">
      
        <p>用<code>hexo generate</code>的时候有时强制中断了，下次再重新generate就会失败, 预计是<code>db.json</code>还没有完全生成完，而重新generate的时候会去尝试读<code>db.json</code>，这个时候就会报错，删除<code>db.json</code>就ok. 奇怪的是作者为什么在报错之后不直接重新生成<code>db.json</code>，毕竟这个文件只是用来做server的数据库，莫非还有别的用途?</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-08-06T03:34:06.000Z">8月 6 2013</time>
      
      
  
    <h1 class="title"><a href="/2013/08/06/svg-spec/">SVG Spec</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="SVG的Painters_model">SVG的Painters model</h3>
<p>每个操作都会向输出设备修改某块区域的绘图，而不管之前在这块区域内的绘制是什么。这和很多的绘图或现实模型相似，接近底层容易实现。没有透明度的情况下，新的绘制会直接覆盖原来的区域，而有透明度的设置时，最终结果则按照Alpha Blending来计算。</p>
<h3 id="Rendering_Order">Rendering Order</h3>
<p>元素在svg内的排列顺序暗含了元素的绘制顺序，svg document fragment的第一个元素将会首先被绘制到输出设备上。</p>
<h3 id="groups">groups</h3>
<p>‘g’元素实际上是穿件了一个临时的独立的背景色为黑色但是背景透明的画布,’g’的子元素则在这块画布上进行绘制</p>
<h3 id="types_of_graphics_elements">types of graphics elements</h3>
<p>SVG支持三种基本的图形元素:</p>
<ul>
<li>Shapes: 用到最多的，主要由各种线和填充构成</li>
<li>Text: 字符的组合</li>
<li>Raster images: 类似于bitmap,是一组包含了颜色，透明度信息的数组</li>
</ul>
<h4 id="Shapes_and_Text">Shapes and Text</h4>
<p>字符实际上最终也是形状的一种，由<strong>stroke</strong>和<strong>fill</strong>构成, 对于有一些形状, 比如path, 可以定义一些<strong>marker symbol</strong>,主要用来绘制箭头等。<br>其中<strong>fill</strong>首先被绘制，然后是<strong>stroke</strong>, 最后是<strong>marker symbol</strong>, <strong>marker</strong>的绘制顺序是沿着形状的outline来进行，从形状的起始点开始到结束点。</p>
<p>Ref: <a href="http://www.w3.org/TR/SVG/render" target="_blank">http://www.w3.org/TR/SVG/render.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-07-08T01:30:00.000Z">7月 8 2013</time>
      
      
  
    <h1 class="title"><a href="/2013/07/08/hostname-in-mac/">hostname in mac</a></h1>
  

    </header>
    <div class="entry">
      
        <p>在改写一个保存tmux状态的脚本(tmux-resurrect)的时候发现<code>hostname</code>这个命令拿到的是ip地址而不是我PROMPT里面的命令，这两个怎么会不一样呢？</p>
<p>在prompt里面的%m hostname通过以下途径获得：</p>
<ol>
<li>/etc/hostconfig: 在这个配置文件中配置</li>
<li>如果没找到就去/Library/Preferences/SystemConfiguration/preferences.plist中的’System&gt;System&gt;HostName’值</li>
<li>如果这个值为空，则通过逆向DNS查询找到ip地址</li>
<li>如果查询没找到才会用/Library/Preferences/SystemConfiguration/preferences.plist中的’System&gt;Network&gt;HostNames&gt;LocalHOstName’，这个也是用户在系统配置中的共享里配置的名字</li>
<li>最后如果这个也没查到，那就会返回localhost</li>
</ol>
<p>所以由于我hostconfig没配置，然后就找到preferences.plist中的HostName，也就是第二项。</p>
<p>而hostname命令就不一样了，好吧，这个过程是怎么样我也没找到，应该除了上述几个地方还有一些mac自己存放的配置文件，通过<code>scutil</code>来修改。只不过顺序和具体包含哪些不是很清楚。<br>只不过其中DNS查询在去找preferences.plist之前，所以我的<code>hostname</code>会返回ip地址</p>
<p>修改则可以通过</p>
<pre><code><span class="built_in">sudo</span> scutil --set HostName &lt;hostname&gt;
</code></pre><p>具体命令其他用法可以查看scutil(8) man page,可以看到 这个命令可以用来设置ComputerName LocalHostName和HostName。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-05-31T06:30:00.000Z">5月 31 2013</time>
      
      
  
    <h1 class="title"><a href="/2013/05/31/html5/">HTML5</a></h1>
  

    </header>
    <div class="entry">
      
        <p><a href="http://dev.w3.org/html5/spec/Overview.html#introduction" target="_blank">http://dev.w3.org/html5/spec/Overview.html#introduction</a><br>HTML5 各方角力又开始了</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




<nav id="pagination">
  
  
    <a href="/page/2/" class="alignright next">下一页</a>
  
  <div class="clearfix"></div>
</nav></div></div>
    <aside id="sidebar" class="alignright">
<div class="search">
  <form action="http://google.com/search" method="get" accept-charset="utf-8">
    <input type="text" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:villadora.github.io">
  </form>
</div>


<div class="widget social">  
  <h3 class="title">链接</h3>
  <ul>
  <li>
    <a class="github" href="http://github.com/villadora">github</a>
  </li>
  <li>
    <a class="twitter" href="http://twitter.com/villadora">twitter</a>
  </li>
  <li>
    <a class="douban" href="http://www.douban.com/people/villadora">douban</a>
  </li>
  </ul>
</div>



<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/编译器/">编译器</a><small>1</small></li>
  
    <li><a href="/categories/C++/">C++</a><small>1</small></li>
  
    <li><a href="/categories/DotNet/">DotNet</a><small>1</small></li>
  
    <li><a href="/categories/Web/">Web</a><small>2</small></li>
  
    <li><a href="/categories/Web/HTML5/">HTML5</a><small>1</small></li>
  
    <li><a href="/categories/Nodejs/">Nodejs</a><small>1</small></li>
  
    <li><a href="/categories/Java/">Java</a><small>1</small></li>
  
  </ul>
</div>



<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <a href="/tags/Games/"><li>Games<small>1</small></li></a>
  
    <a href="/tags/rubik's cube/"><li>rubik&#39;s cube<small>1</small></li></a>
  
    <a href="/tags/rubic, cube/"><li>rubic, cube<small>1</small></li></a>
  
    <a href="/tags/computer/"><li>computer<small>1</small></li></a>
  
    <a href="/tags/compiler/"><li>compiler<small>1</small></li></a>
  
    <a href="/tags/SSA/"><li>SSA<small>1</small></li></a>
  
    <a href="/tags/C++/"><li>C++<small>1</small></li></a>
  
    <a href="/tags/smart point/"><li>smart point<small>1</small></li></a>
  
    <a href="/tags/c#/"><li>c#<small>1</small></li></a>
  
    <a href="/tags/notes/"><li>notes<small>1</small></li></a>
  
    <a href="/tags/笔记/"><li>笔记<small>1</small></li></a>
  
    <a href="/tags/dotnet/"><li>dotnet<small>1</small></li></a>
  
    <a href="/tags/web, mobile/"><li>web, mobile<small>1</small></li></a>
  
    <a href="/tags/html5/"><li>html5<small>1</small></li></a>
  
    <a href="/tags/web/"><li>web<small>1</small></li></a>
  
    <a href="/tags/barcamp/"><li>barcamp<small>1</small></li></a>
  
    <a href="/tags/shanghai/"><li>shanghai<small>1</small></li></a>
  
    <a href="/tags/虚拟机/"><li>虚拟机<small>1</small></li></a>
  
    <a href="/tags/virtualbox/"><li>virtualbox<small>1</small></li></a>
  
    <a href="/tags/网络/"><li>网络<small>1</small></li></a>
  
    <a href="/tags/nat/"><li>nat<small>1</small></li></a>
  
    <a href="/tags/bridgedappter/"><li>bridgedappter<small>1</small></li></a>
  
    <a href="/tags/graphviz/"><li>graphviz<small>1</small></li></a>
  
    <a href="/tags/图形学/"><li>图形学<small>1</small></li></a>
  
    <a href="/tags/layout/"><li>layout<small>1</small></li></a>
  
    <a href="/tags/读书/"><li>读书<small>2</small></li></a>
  
    <a href="/tags/历史/"><li>历史<small>1</small></li></a>
  
    <a href="/tags/程序员/"><li>程序员<small>1</small></li></a>
  
    <a href="/tags/经济/"><li>经济<small>2</small></li></a>
  
    <a href="/tags/专业化/"><li>专业化<small>1</small></li></a>
  
    <a href="/tags/读后感/"><li>读后感<small>1</small></li></a>
  
    <a href="/tags/思维方式/"><li>思维方式<small>1</small></li></a>
  
    <a href="/tags/分析/"><li>分析<small>1</small></li></a>
  
    <a href="/tags/学习/"><li>学习<small>1</small></li></a>
  
    <a href="/tags/全球化/"><li>全球化<small>1</small></li></a>
  
    <a href="/tags/泡沫/"><li>泡沫<small>1</small></li></a>
  
    <a href="/tags/经济,股市,发行审核制度/"><li>经济,股市,发行审核制度<small>1</small></li></a>
  
    <a href="/tags/编程, Ruby, slice, stackoverflow/"><li>编程, Ruby, slice, stackoverflow<small>1</small></li></a>
  
    <a href="/tags/IDE, Eclipse, Orion, Web/"><li>IDE, Eclipse, Orion, Web<small>1</small></li></a>
  
    <a href="/tags/IE7, bugs/"><li>IE7, bugs<small>1</small></li></a>
  
    <a href="/tags/javascript/"><li>javascript<small>4</small></li></a>
  
    <a href="/tags/synchronize/"><li>synchronize<small>1</small></li></a>
  
    <a href="/tags/git, customize/"><li>git, customize<small>1</small></li></a>
  
    <a href="/tags/nodejs, chil_process, spawn, exec/"><li>nodejs, chil_process, spawn, exec<small>1</small></li></a>
  
    <a href="/tags/type/"><li>type<small>1</small></li></a>
  
    <a href="/tags/prototype/"><li>prototype<small>1</small></li></a>
  
    <a href="/tags/javascript, ast, parse, minification/"><li>javascript, ast, parse, minification<small>1</small></li></a>
  
    <a href="/tags/emacs, auto-mode/"><li>emacs, auto-mode<small>1</small></li></a>
  
    <a href="/tags/mac, linux/"><li>mac, linux<small>1</small></li></a>
  
    <a href="/tags/hexo, interupt/"><li>hexo, interupt<small>1</small></li></a>
  
    <a href="/tags/svg, web, spec/"><li>svg, web, spec<small>1</small></li></a>
  
    <a href="/tags/javascript, Array.push, push, Range Error/"><li>javascript, Array.push, push, Range Error<small>1</small></li></a>
  
    <a href="/tags/passport/"><li>passport<small>1</small></li></a>
  
    <a href="/tags/openid/"><li>openid<small>1</small></li></a>
  
    <a href="/tags/nodejs/"><li>nodejs<small>1</small></li></a>
  
    <a href="/tags/cluster/"><li>cluster<small>1</small></li></a>
  
    <a href="/tags/mobile/"><li>mobile<small>1</small></li></a>
  
    <a href="/tags/android/"><li>android<small>1</small></li></a>
  
    <a href="/tags/iscroll/"><li>iscroll<small>1</small></li></a>
  
    <a href="/tags/java/"><li>java<small>1</small></li></a>
  
    <a href="/tags/cookie/"><li>cookie<small>1</small></li></a>
  
    <a href="/tags/version/"><li>version<small>1</small></li></a>
  
    <a href="/tags/ie, regexp, browsers/"><li>ie, regexp, browsers<small>1</small></li></a>
  
    <a href="/tags/AMD, CommonJS, require2commonjs, node/"><li>AMD, CommonJS, require2commonjs, node<small>1</small></li></a>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2014 Villa Dora
  
  <br />
  Powered by <a href="http://zespia.tw/hexo/">Hexo</a>
</div>
<div class="alignright license">
<img alt="知识共享许可协议" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /> 本站作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">知识共享署名-非商业性使用-相同方式共享 3.0 未本地化版本许可协议</a>进行许可。
</div>
<div class="clearfix"></div>
</footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'villadora-blog';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>
